{{ define "editor" }}
{{ template "inc_head" . }}

<div class="container" id="editor" {{ if .EnablePointInPolygon}}data-point-in-polygon="enabled" data-point-in-polygon-endpoint="{{ EnsureRoot .PointInPolygonEndpoint }}" data-point-in-polygon-data-endpoint="{{ EnsureRoot .PointInPolygonDataEndpoint }}"{{ end }}{{ if .EnableWriter }} data-writer-path="{{ EnsureRoot .WriterPath }}"{{ end }}{{ if .EnableOEmbedCORSImage }} data-oembed-cors-image="enabled"{{ end }}{{ if .EnableExifWriter }} data-update-exif-uri="{{ EnsureRoot "/wasm/update_exif.wasm" }}"{{ end }}>


    <div class="col" id="col-map">	
	<div id="map" data-map-renderer="{{ .MapRenderer }}"></div>		
    </div>

    <div class="col" id="col-controls">

	<div id="controls">

	<details class="control">
		<summary>Image</summary>
	    
		<div>
		    <div>
			<!-- TO DO: https://getbootstrap.com/docs/5.0/components/carousel/ -->
			<!-- See also: geotag.editor.init.js -->
			<div id="image-wrapper"></div>
			<div id="image-meta"></div>
		    </div>
		    
		    <div class="image-form">
			<form class="form">
			    
			    <div class="form-group">
				<label for="file-attachment">Load an image</label>
				<!-- https://github.com/github/file-attachment-element -->
				<file-attachment input="file" id="file-attachment">
				    <input type="file" id="file" multiple class="form-control" />
				</file-attachment>

			    </div>
			    
			    {{ if .EnableOEmbed }}			
			    <div class="form-group">
				<label for="oembed-url">Fetch an image</label>					
				<input class="form-control mr-sm-2" type="search" name="oembed-url" id="oembed-url" placeholder="Enter a URL to retrieve" value="" aria-label="Fetch" aria-describedby="oembed-url-help" />
				<small id="oembed-url-help" class="form-text text-muted">A valid OEmbed URL for retrieving an image to display. <small id="oembed-valid-endpoints"></span></small>		
			    </div>
			    <button class="btn btn-primary pull-right" type="submit" id="oembed-fetch">Fetch</button>
			    {{ end }}
			    
			</form>
		    </div>
		</div>
	</details>
	
	{{ if .EnablePointInPolygon }}

	<details class="control">
		<summary>Point in polygon</summary>
		<form id="point-in-polygon">
		    <div id="point-in-polygon-candidates" class="form-group">&#160;</div>

		    <details class="control">
			<summary>Filter</summary>
			<div class="form-group">
			    <label for="inception">Inception date</label>
			    <input type="text" value="" id="point-in-polygon-inception" placeholder="inception" class="form-control" aria-describedby="inception-help"/>
			    <small id="inception-help" class="form-text text-muted">A valid EDTF string to filter result's inception date with.</small>
			</div>
			<div class="form-group">
			    <label for="cessation">Cessation date</label>			
			    <input type="text" value="" id="point-in-polygon-cessation" placeholder="cessation" class="form-control" aria-describedby="cessation-help"/>
			    <small id="cessation-help" class="form-text text-muted">A valid EDTF string to filter result's cessation date with.</small>			
			</div>
		    </details>
		    
		</form>
	</details>
	{{ end }}

	</div>
	
    </div>

    <div class="col" id="col-output">    
	<div id="feature"></div>
	
    	{{ if or .EnableWriter .EnableExifWriter }}
	<div id="writer-save-wrapper">
	    {{ if .EnableExifWriter }}
	    <small class="writer-save-caveat">Note: Only the camera's focal point will be saved as <code>GPSLatitude</code> and <code>GPSLongitude</code> EXIF properties.</small>	    
	    <button id="writer-save" class="btn btn-primary">Save to EXIF</button>
	{{ else }}
	<button id="writer-save" class="btn btn-primary">Save</button>
	{{ end }}
	</div>	
	{{ end }}
    </div>

</div>

{{ template "inc_foot" . }}
{{ end }}
