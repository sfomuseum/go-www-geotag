var protomaps=(()=>{var Lt=Object.create,ae=Object.defineProperty,_t=Object.getPrototypeOf,Mt=Object.prototype.hasOwnProperty,St=Object.getOwnPropertyNames,zt=Object.getOwnPropertyDescriptor;var kt=t=>ae(t,"__esModule",{value:!0});var P=(t,e)=>()=>(e||(e={exports:{}},t(e.exports,e)),e.exports),Tt=(t,e)=>{for(var i in e)ae(t,i,{get:e[i],enumerable:!0})},Bt=(t,e,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of St(e))!Mt.call(t,r)&&r!=="default"&&ae(t,r,{get:()=>e[r],enumerable:!(i=zt(e,r))||i.enumerable});return t},E=t=>Bt(kt(ae(t!=null?Lt(_t(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var H=P((di,Ue)=>{"use strict";Ue.exports=W;function W(t,e){this.x=t,this.y=e}W.prototype={clone:function(){return new W(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=e*this.x-i*this.y,n=i*this.x+e*this.y;return this.x=r,this.y=n,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.x+i*(this.x-e.x)-r*(this.y-e.y),s=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=n,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};W.convert=function(t){return t instanceof W?t:Array.isArray(t)?new W(t[0],t[1]):t}});var be=P((ci,Ze)=>{"use strict";var Dt=H();Ze.exports=Q;function Q(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(Ct,this,e)}function Ct(t,e,i){t==1?e.id=i.readVarint():t==2?Vt(i,e):t==3?e.type=i.readVarint():t==4&&(e._geometry=i.pos)}function Vt(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n}}Q.types=["Unknown","Point","LineString","Polygon"];Q.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,s=0,a=[],o;t.pos<e;){if(r<=0){var h=t.readVarint();i=h&7,r=h>>3}if(r--,i===1||i===2)n+=t.readSVarint(),s+=t.readSVarint(),i===1&&(o&&a.push(o),o=[]),o.push(new Dt(n,s));else if(i===7)o&&o.push(o[0].clone());else throw new Error("unknown command "+i)}return o&&a.push(o),a};Q.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,s=0,a=Infinity,o=-Infinity,h=Infinity,d=-Infinity;t.pos<e;){if(r<=0){var u=t.readVarint();i=u&7,r=u>>3}if(r--,i===1||i===2)n+=t.readSVarint(),s+=t.readSVarint(),n<a&&(a=n),n>o&&(o=n),s<h&&(h=s),s>d&&(d=s);else if(i!==7)throw new Error("unknown command "+i)}return[a,h,o,d]};Q.prototype.toGeoJSON=function(t,e,i){var r=this.extent*Math.pow(2,i),n=this.extent*t,s=this.extent*e,a=this.loadGeometry(),o=Q.types[this.type],h,d;function u(w){for(var m=0;m<w.length;m++){var v=w[m],l=180-(v.y+s)*360/r;w[m]=[(v.x+n)*360/r-180,360/Math.PI*Math.atan(Math.exp(l*Math.PI/180))-90]}}switch(this.type){case 1:var x=[];for(h=0;h<a.length;h++)x[h]=a[h][0];a=x,u(a);break;case 2:for(h=0;h<a.length;h++)u(a[h]);break;case 3:for(a=Pt(a),h=0;h<a.length;h++)for(d=0;d<a[h].length;d++)u(a[h][d]);break}a.length===1?a=a[0]:o="Multi"+o;var y={type:"Feature",geometry:{type:o,coordinates:a},properties:this.properties};return"id"in this&&(y.id=this.id),y};function Pt(t){var e=t.length;if(e<=1)return[t];for(var i=[],r,n,s=0;s<e;s++){var a=Rt(t[s]);a!==0&&(n===void 0&&(n=a<0),n===a<0?(r&&i.push(r),r=[t[s]]):r.push(t[s]))}return r&&i.push(r),i}function Rt(t){for(var e=0,i=0,r=t.length,n=r-1,s,a;i<r;n=i++)s=t[i],a=t[n],e+=(a.x-s.x)*(s.y+a.y);return e}});var ve=P((xi,Ae)=>{"use strict";var Xt=be();Ae.exports=qe;function qe(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Et,this,e),this.length=this._features.length}function Et(t,e,i){t===15?e.version=i.readVarint():t===1?e.name=i.readString():t===5?e.extent=i.readVarint():t===2?e._features.push(i.pos):t===3?e._keys.push(i.readString()):t===4&&e._values.push(Yt(i))}function Yt(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}qe.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Xt(this._pbf,e,this.extent,this._keys,this._values)}});var Ne=P((mi,je)=>{"use strict";var It=ve();je.exports=Ut;function Ut(t,e){this.layers=t.readFields(Zt,{},e)}function Zt(t,e,i){if(t===3){var r=new It(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r)}}});var Oe=P((yi,oe)=>{oe.exports.VectorTile=Ne();oe.exports.VectorTileFeature=be();oe.exports.VectorTileLayer=ve()});var We=P(Fe=>{Fe.read=function(t,e,i,r,n){var s,a,o=n*8-r-1,h=(1<<o)-1,d=h>>1,u=-7,x=i?n-1:0,y=i?-1:1,w=t[e+x];for(x+=y,s=w&(1<<-u)-1,w>>=-u,u+=o;u>0;s=s*256+t[e+x],x+=y,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=r;u>0;a=a*256+t[e+x],x+=y,u-=8);if(s===0)s=1-d;else{if(s===h)return a?NaN:(w?-1:1)*Infinity;a=a+Math.pow(2,r),s=s-d}return(w?-1:1)*a*Math.pow(2,s-r)};Fe.write=function(t,e,i,r,n,s){var a,o,h,d=s*8-n-1,u=(1<<d)-1,x=u>>1,y=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=r?0:s-1,m=r?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===Infinity?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),a+x>=1?e+=y/h:e+=y*Math.pow(2,1-x),e*h>=2&&(a++,h/=2),a+x>=u?(o=0,a=u):a+x>=1?(o=(e*h-1)*Math.pow(2,n),a=a+x):(o=e*Math.pow(2,x-1)*Math.pow(2,n),a=0));n>=8;t[i+w]=o&255,w+=m,o/=256,n-=8);for(a=a<<n|o,d+=n;d>0;t[i+w]=a&255,w+=m,a/=256,d-=8);t[i+w-m]|=v*128}});var Ke=P((gi,He)=>{"use strict";He.exports=z;var le=We();function z(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}z.Varint=0;z.Fixed64=1;z.Bytes=2;z.Fixed32=5;var Le=(1<<16)*(1<<16),Qe=1/Le,At=12,$e=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");z.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,s=this.pos;this.type=r&7,t(n,e,this),this.pos===s&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=he(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Je(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=he(this.buf,this.pos)+he(this.buf,this.pos+4)*Le;return this.pos+=8,t},readSFixed64:function(){var t=he(this.buf,this.pos)+Je(this.buf,this.pos+4)*Le;return this.pos+=8,t},readFloat:function(){var t=le.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=le.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,i,r;return r=e[this.pos++],i=r&127,r<128||(r=e[this.pos++],i|=(r&127)<<7,r<128)||(r=e[this.pos++],i|=(r&127)<<14,r<128)||(r=e[this.pos++],i|=(r&127)<<21,r<128)?i:(r=e[this.pos],i|=(r&15)<<28,qt(i,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=At&&$e?ti(this.buf,e,t):ei(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==z.Bytes)return t.push(this.readVarint(e));var i=Y(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==z.Bytes)return t.push(this.readSVarint());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==z.Bytes)return t.push(this.readBoolean());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==z.Bytes)return t.push(this.readFloat());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==z.Bytes)return t.push(this.readDouble());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==z.Bytes)return t.push(this.readFixed32());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==z.Bytes)return t.push(this.readSFixed32());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==z.Bytes)return t.push(this.readFixed64());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==z.Bytes)return t.push(this.readSFixed64());var e=Y(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===z.Varint)for(;this.buf[this.pos++]>127;);else if(e===z.Bytes)this.pos=this.readVarint()+this.pos;else if(e===z.Fixed32)this.pos+=4;else if(e===z.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),$(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),$(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),$(this.buf,t&-1,this.pos),$(this.buf,Math.floor(t*Qe),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),$(this.buf,t&-1,this.pos),$(this.buf,Math.floor(t*Qe),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){jt(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=ii(this.buf,t,this.pos);var i=this.pos-e;i>=128&&Ge(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),le.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),le.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;r>=128&&Ge(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,i){this.writeTag(t,z.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Nt,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Ot,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Qt,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Wt,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Ht,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,$t,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Gt,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Jt,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Kt,e)},writeBytesField:function(t,e){this.writeTag(t,z.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,z.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,z.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,z.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,z.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,z.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,z.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,z.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,z.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,z.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};function qt(t,e,i){var r=i.buf,n,s;if(s=r[i.pos++],n=(s&112)>>4,s<128||(s=r[i.pos++],n|=(s&127)<<3,s<128)||(s=r[i.pos++],n|=(s&127)<<10,s<128)||(s=r[i.pos++],n|=(s&127)<<17,s<128)||(s=r[i.pos++],n|=(s&127)<<24,s<128)||(s=r[i.pos++],n|=(s&1)<<31,s<128))return G(t,n,e);throw new Error("Expected varint not more than 10 bytes")}function Y(t){return t.type===z.Bytes?t.readVarint()+t.pos:t.pos+1}function G(t,e,i){return i?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function jt(t,e){var i,r;if(t>=0?(i=t%4294967296|0,r=t/4294967296|0):(i=~(-t%4294967296),r=~(-t/4294967296),i^4294967295?i=i+1|0:(i=0,r=r+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),ri(i,r,e),ni(r,e)}function ri(t,e,i){i.buf[i.pos++]=t&127|128,t>>>=7,i.buf[i.pos++]=t&127|128,t>>>=7,i.buf[i.pos++]=t&127|128,t>>>=7,i.buf[i.pos++]=t&127|128,t>>>=7,i.buf[i.pos]=t&127}function ni(t,e){var i=(t&7)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),!!t&&(e.buf[e.pos++]=t&127)))))}function Ge(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));i.realloc(r);for(var n=i.pos-1;n>=t;n--)i.buf[n+r]=i.buf[n]}function Nt(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Ot(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Wt(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Ht(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Qt(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function $t(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function Gt(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Jt(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function Kt(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function he(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function $(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function Je(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ei(t,e,i){for(var r="",n=e;n<i;){var s=t[n],a=null,o=s>239?4:s>223?3:s>191?2:1;if(n+o>i)break;var h,d,u;o===1?s<128&&(a=s):o===2?(h=t[n+1],(h&192)==128&&(a=(s&31)<<6|h&63,a<=127&&(a=null))):o===3?(h=t[n+1],d=t[n+2],(h&192)==128&&(d&192)==128&&(a=(s&15)<<12|(h&63)<<6|d&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):o===4&&(h=t[n+1],d=t[n+2],u=t[n+3],(h&192)==128&&(d&192)==128&&(u&192)==128&&(a=(s&15)<<18|(h&63)<<12|(d&63)<<6|u&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,o=1):a>65535&&(a-=65536,r+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),r+=String.fromCharCode(a),n+=o}return r}function ti(t,e,i){return $e.decode(t.subarray(e,i))}function ii(t,e,i){for(var r=0,n,s;r<e.length;r++){if(n=e.charCodeAt(r),n>55295&&n<57344)if(s)if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,s=n;continue}else n=s-55296<<10|n-56320|65536,s=null;else{n>56319||r+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):s=n;continue}else s&&(t[i++]=239,t[i++]=191,t[i++]=189,s=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=n&63|128)}return i}});var tt=P((et,fe)=>{(function(t,e){typeof define=="function"&&define.amd?define([],e):typeof fe=="object"&&fe.exports?fe.exports=e():t.pmtiles=e()})(typeof self!="undefined"?self:et,function(){let t=(a,o)=>a*Math.pow(2,o),e=(a,o)=>t(a.getUint16(o+1,!0),8)+a.getUint8(o,!0),i=(a,o)=>t(a.getUint32(o+2,!0),16)+a.getUint16(o,!0),r=a=>{var o=a.getUint16(0,!0),h=a.getUint16(2,!0),d=a.getUint32(4,!0),u=a.getUint16(8,!0);return{version:h,json_size:d,root_entries:u}},n=a=>{let o=new Map;for(var h=0;h<a.byteLength;h+=17){var d=a.getUint8(h,!0),u=d&127,x=d>>7,y=e(a,h+1),w=e(a,h+4),m=i(a,h+7),v=a.getUint32(h+13,!0);o.set(u+"_"+y+"_"+w,[m,v,x])}return o};class s{constructor(o,h={}){this.url=o,this.root=fetch(this.url,{method:"HEAD",headers:{Range:"bytes=0-511999"}}).then(d=>{if(d.status==206||d.status==200&&h.allow_200)return console.log("Check succeeded: server supports byte ranges"),fetch(this.url,{headers:{Range:"bytes=0-511999"}}).then(u=>u.arrayBuffer()).then(u=>{let x=r(new DataView(u,0,10));var y=new TextDecoder("utf-8");return{metadata:JSON.parse(y.decode(new DataView(u,10,x.json_size))),dir:n(new DataView(u,10+x.json_size,17*x.root_entries))}});throw new Error("Invalid response: "+d.status)}),this.step=0,this.leaves=new Map,this.outstanding_requests=new Map}metadata=o=>{this.root.then(h=>{o(h.metadata)})};getLeaf=(o,h)=>new Promise((d,u)=>{this.leaves.has(o)?(this.leaves.get(o)[0]++,d(this.leaves.get(o)[1])):this.outstanding_requests.has(o)?this.outstanding_requests.get(o).push(d):(this.outstanding_requests.set(o,[]),fetch(this.url,{headers:{Range:"bytes="+o+"-"+(o+h-1)}}).then(x=>x.arrayBuffer()).then(x=>{var y=n(new DataView(x),h/17);if(this.leaves.size>32){var w=Infinity,m=void 0;this.leaves.forEach((v,l)=>{v[0]<w&&(w=v[0],m=l)}),this.leaves.delete(m)}this.leaves.set(o,[this.step++,y]),d(y),this.outstanding_requests.get(o).forEach(v=>v(y)),this.outstanding_requests.delete(o)}))});getZxy=(o,h,d)=>{var u=o+"_"+h+"_"+d;return this.root.then(x=>{if(x.dir.has(u)&&x.dir.get(u)[2]==0)return x.dir.get(u);if(o>=7){var y=o-7,w=[7,Math.trunc(h/(1<<y)),Math.trunc(d/(1<<y))],m=w[0]+"_"+w[1]+"_"+w[2];if(x.dir.has(m)&&x.dir.get(m)[2]==1){let v=x.dir.get(m);return this.getLeaf(v[0],v[1]).then(l=>l.has(u)?l.get(u):null)}}return null})};transformRequest=(o,h,d,u)=>{if(o.endsWith(".pmtiles")&&u){var x=d.tileID.canonical,y=x.z+"_"+x.x+"_"+x.y;this.getZxy(x.z,x.x,x.y).then(w=>{w&&u({url:this.url,headers:{Range:"bytes="+w[0]+"-"+(w[0]+w[1]-1)}})})}return{url:o}};leafletLayer=o=>{let h=this;var d=L.GridLayer.extend({createTile:function(u,x){var y=document.createElement("img"),w;return h.getZxy(u.z,u.x,u.y).then(m=>{m!==null&&fetch(h.url,{headers:{Range:"bytes="+m[0]+"-"+(m[0]+m[1]-1)}}).then(v=>v.arrayBuffer()).then(v=>{var l=new Blob([v],{type:"image/png"}),f=window.URL.createObjectURL(l);y.src=f,x(w,y)})}),y},_removeTile:function(u){var x=this._tiles[u];!x||(x.el.width=0,x.el.height=0,x.el.deleted=!0,L.DomUtil.remove(x.el),delete this._tiles[u],this.fire("tileunload",{tile:x.el,coords:this._keyToTileCoords(u)}))}});return new d(o)}}return{PMTiles:s}})});var at=P((Te,Be)=>{(function(t,e){typeof Te=="object"&&typeof Be!="undefined"?Be.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self).RBush=e()})(Te,function(){"use strict";function t(l,f,c,g,p){(function b(F,_,M,S,T){for(;S>M;){if(S-M>600){var k=S-M+1,D=_-M+1,K=Math.log(k),A=.5*Math.exp(2*K/3),N=.5*Math.sqrt(K*A*(k-A)/k)*(D-k/2<0?-1:1),O=Math.max(M,Math.floor(_-D*A/k+N)),Ft=Math.min(S,Math.floor(_+(k-D)*A/k+N));b(F,_,O,Ft,T)}var se=F[_],ee=M,X=S;for(e(F,M,_),T(F[S],se)>0&&e(F,M,S);ee<X;){for(e(F,ee,X),ee++,X--;T(F[ee],se)<0;)ee++;for(;T(F[X],se)>0;)X--}T(F[M],se)===0?e(F,M,X):e(F,++X,S),X<=_&&(M=X+1),_<=X&&(S=X-1)}})(l,f,c||0,g||l.length-1,p||i)}function e(l,f,c){var g=l[f];l[f]=l[c],l[c]=g}function i(l,f){return l<f?-1:l>f?1:0}var r=function(l){l===void 0&&(l=9),this._maxEntries=Math.max(4,l),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(l,f,c){if(!c)return f.indexOf(l);for(var g=0;g<f.length;g++)if(c(l,f[g]))return g;return-1}function s(l,f){a(l,0,l.children.length,f,l)}function a(l,f,c,g,p){p||(p=m(null)),p.minX=1/0,p.minY=1/0,p.maxX=-1/0,p.maxY=-1/0;for(var b=f;b<c;b++){var F=l.children[b];o(p,l.leaf?g(F):F)}return p}function o(l,f){return l.minX=Math.min(l.minX,f.minX),l.minY=Math.min(l.minY,f.minY),l.maxX=Math.max(l.maxX,f.maxX),l.maxY=Math.max(l.maxY,f.maxY),l}function h(l,f){return l.minX-f.minX}function d(l,f){return l.minY-f.minY}function u(l){return(l.maxX-l.minX)*(l.maxY-l.minY)}function x(l){return l.maxX-l.minX+(l.maxY-l.minY)}function y(l,f){return l.minX<=f.minX&&l.minY<=f.minY&&f.maxX<=l.maxX&&f.maxY<=l.maxY}function w(l,f){return f.minX<=l.maxX&&f.minY<=l.maxY&&f.maxX>=l.minX&&f.maxY>=l.minY}function m(l){return{children:l,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(l,f,c,g,p){for(var b=[f,c];b.length;)if(!((c=b.pop())-(f=b.pop())<=g)){var F=f+Math.ceil((c-f)/g/2)*g;t(l,F,f,c,p),b.push(f,F,F,c)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(l){var f=this.data,c=[];if(!w(l,f))return c;for(var g=this.toBBox,p=[];f;){for(var b=0;b<f.children.length;b++){var F=f.children[b],_=f.leaf?g(F):F;w(l,_)&&(f.leaf?c.push(F):y(l,_)?this._all(F,c):p.push(F))}f=p.pop()}return c},r.prototype.collides=function(l){var f=this.data;if(!w(l,f))return!1;for(var c=[];f;){for(var g=0;g<f.children.length;g++){var p=f.children[g],b=f.leaf?this.toBBox(p):p;if(w(l,b)){if(f.leaf||y(l,b))return!0;c.push(p)}}f=c.pop()}return!1},r.prototype.load=function(l){if(!l||!l.length)return this;if(l.length<this._minEntries){for(var f=0;f<l.length;f++)this.insert(l[f]);return this}var c=this._build(l.slice(),0,l.length-1,0);if(this.data.children.length)if(this.data.height===c.height)this._splitRoot(this.data,c);else{if(this.data.height<c.height){var g=this.data;this.data=c,c=g}this._insert(c,this.data.height-c.height-1,!0)}else this.data=c;return this},r.prototype.insert=function(l){return l&&this._insert(l,this.data.height-1),this},r.prototype.clear=function(){return this.data=m([]),this},r.prototype.remove=function(l,f){if(!l)return this;for(var c,g,p,b=this.data,F=this.toBBox(l),_=[],M=[];b||_.length;){if(b||(b=_.pop(),g=_[_.length-1],c=M.pop(),p=!0),b.leaf){var S=n(l,b.children,f);if(S!==-1)return b.children.splice(S,1),_.push(b),this._condense(_),this}p||b.leaf||!y(b,F)?g?(c++,b=g.children[c],p=!1):b=null:(_.push(b),M.push(c),c=0,g=b,b=b.children[0])}return this},r.prototype.toBBox=function(l){return l},r.prototype.compareMinX=function(l,f){return l.minX-f.minX},r.prototype.compareMinY=function(l,f){return l.minY-f.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(l){return this.data=l,this},r.prototype._all=function(l,f){for(var c=[];l;)l.leaf?f.push.apply(f,l.children):c.push.apply(c,l.children),l=c.pop();return f},r.prototype._build=function(l,f,c,g){var p,b=c-f+1,F=this._maxEntries;if(b<=F)return s(p=m(l.slice(f,c+1)),this.toBBox),p;g||(g=Math.ceil(Math.log(b)/Math.log(F)),F=Math.ceil(b/Math.pow(F,g-1))),(p=m([])).leaf=!1,p.height=g;var _=Math.ceil(b/F),M=_*Math.ceil(Math.sqrt(F));v(l,f,c,M,this.compareMinX);for(var S=f;S<=c;S+=M){var T=Math.min(S+M-1,c);v(l,S,T,_,this.compareMinY);for(var k=S;k<=T;k+=_){var D=Math.min(k+_-1,T);p.children.push(this._build(l,k,D,g-1))}}return s(p,this.toBBox),p},r.prototype._chooseSubtree=function(l,f,c,g){for(;g.push(f),!f.leaf&&g.length-1!==c;){for(var p=1/0,b=1/0,F=void 0,_=0;_<f.children.length;_++){var M=f.children[_],S=u(M),T=(k=l,D=M,(Math.max(D.maxX,k.maxX)-Math.min(D.minX,k.minX))*(Math.max(D.maxY,k.maxY)-Math.min(D.minY,k.minY))-S);T<b?(b=T,p=S<p?S:p,F=M):T===b&&S<p&&(p=S,F=M)}f=F||f.children[0]}var k,D;return f},r.prototype._insert=function(l,f,c){var g=c?l:this.toBBox(l),p=[],b=this._chooseSubtree(g,this.data,f,p);for(b.children.push(l),o(b,g);f>=0&&p[f].children.length>this._maxEntries;)this._split(p,f),f--;this._adjustParentBBoxes(g,p,f)},r.prototype._split=function(l,f){var c=l[f],g=c.children.length,p=this._minEntries;this._chooseSplitAxis(c,p,g);var b=this._chooseSplitIndex(c,p,g),F=m(c.children.splice(b,c.children.length-b));F.height=c.height,F.leaf=c.leaf,s(c,this.toBBox),s(F,this.toBBox),f?l[f-1].children.push(F):this._splitRoot(c,F)},r.prototype._splitRoot=function(l,f){this.data=m([l,f]),this.data.height=l.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(l,f,c){for(var g,p,b,F,_,M,S,T=1/0,k=1/0,D=f;D<=c-f;D++){var K=a(l,0,D,this.toBBox),A=a(l,D,c,this.toBBox),N=(p=K,b=A,F=void 0,_=void 0,M=void 0,S=void 0,F=Math.max(p.minX,b.minX),_=Math.max(p.minY,b.minY),M=Math.min(p.maxX,b.maxX),S=Math.min(p.maxY,b.maxY),Math.max(0,M-F)*Math.max(0,S-_)),O=u(K)+u(A);N<T?(T=N,g=D,k=O<k?O:k):N===T&&O<k&&(k=O,g=D)}return g||c-f},r.prototype._chooseSplitAxis=function(l,f,c){var g=l.leaf?this.compareMinX:h,p=l.leaf?this.compareMinY:d;this._allDistMargin(l,f,c,g)<this._allDistMargin(l,f,c,p)&&l.children.sort(g)},r.prototype._allDistMargin=function(l,f,c,g){l.children.sort(g);for(var p=this.toBBox,b=a(l,0,f,p),F=a(l,c-f,c,p),_=x(b)+x(F),M=f;M<c-f;M++){var S=l.children[M];o(b,l.leaf?p(S):S),_+=x(b)}for(var T=c-f-1;T>=f;T--){var k=l.children[T];o(F,l.leaf?p(k):k),_+=x(F)}return _},r.prototype._adjustParentBBoxes=function(l,f,c){for(var g=c;g>=0;g--)o(f[g],l)},r.prototype._condense=function(l){for(var f=l.length-1,c=void 0;f>=0;f--)l[f].children.length===0?f>0?(c=l[f-1].children).splice(c.indexOf(l[f]),1):this.clear():s(l[f],this.toBBox)},r})});var ht=P((Ve,Pe)=>{(function(t,e){typeof Ve=="object"&&typeof Pe!="undefined"?Pe.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self,t.TinyQueue=e())})(Ve,function(){"use strict";var t=function(r,n){if(r===void 0&&(r=[]),n===void 0&&(n=e),this.data=r,this.length=this.data.length,this.compare=n,this.length>0)for(var s=(this.length>>1)-1;s>=0;s--)this._down(s)};t.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(this.length!==0){var r=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),r}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(r){for(var n=this,s=n.data,a=n.compare,o=s[r];r>0;){var h=r-1>>1,d=s[h];if(a(o,d)>=0)break;s[r]=d,r=h}s[r]=o},t.prototype._down=function(r){for(var n=this,s=n.data,a=n.compare,o=this.length>>1,h=s[r];r<o;){var d=(r<<1)+1,u=s[d],x=d+1;if(x<this.length&&a(s[x],u)<0&&(d=x,u=s[x]),a(u,h)>=0)break;s[r]=u,r=d}s[r]=h};function e(i,r){return i<r?-1:i>r?1:0}return t})});var ut=P((Si,Re)=>{"use strict";var xe=ht();xe.default&&(xe=xe.default);Re.exports=ft;Re.exports.default=ft;function ft(t,e,i){e=e||1;for(var r,n,s,a,o=0;o<t[0].length;o++){var h=t[0][o];(!o||h[0]<r)&&(r=h[0]),(!o||h[1]<n)&&(n=h[1]),(!o||h[0]>s)&&(s=h[0]),(!o||h[1]>a)&&(a=h[1])}var d=s-r,u=a-n,x=Math.min(d,u),y=x/2;if(x===0){var w=[r,n];return w.distance=0,w}for(var m=new xe(void 0,si),v=r;v<s;v+=x)for(var l=n;l<a;l+=x)m.push(new I(v+y,l+y,y,t));var f=ai(t),c=new I(r+d/2,n+u/2,0,t);c.d>f.d&&(f=c);for(var g=m.length;m.length;){var p=m.pop();p.d>f.d&&(f=p,i&&console.log("found best %d after %d probes",Math.round(1e4*p.d)/1e4,g)),!(p.max-f.d<=e)&&(y=p.h/2,m.push(new I(p.x-y,p.y-y,y,t)),m.push(new I(p.x+y,p.y-y,y,t)),m.push(new I(p.x-y,p.y+y,y,t)),m.push(new I(p.x+y,p.y+y,y,t)),g+=4)}i&&(console.log("num probes: "+g),console.log("best distance: "+f.d));var b=[f.x,f.y];return b.distance=f.d,b}function si(t,e){return e.max-t.max}function I(t,e,i,r){this.x=t,this.y=e,this.h=i,this.d=oi(t,e,r),this.max=this.d+this.h*Math.SQRT2}function oi(t,e,i){for(var r=!1,n=Infinity,s=0;s<i.length;s++)for(var a=i[s],o=0,h=a.length,d=h-1;o<h;d=o++){var u=a[o],x=a[d];u[1]>e!=x[1]>e&&t<(x[0]-u[0])*(e-u[1])/(x[1]-u[1])+u[0]&&(r=!r),n=Math.min(n,li(t,e,u,x))}return n===0?0:(r?1:-1)*Math.sqrt(n)}function ai(t){for(var e=0,i=0,r=0,n=t[0],s=0,a=n.length,o=a-1;s<a;o=s++){var h=n[s],d=n[o],u=h[0]*d[1]-d[0]*h[1];i+=(h[0]+d[0])*u,r+=(h[1]+d[1])*u,e+=u*3}return e===0?new I(n[0][0],n[0][1],0,t):new I(i/e,r/e,0,t)}function li(t,e,i,r){var n=i[0],s=i[1],a=r[0]-n,o=r[1]-s;if(a!==0||o!==0){var h=((t-n)*a+(e-s)*o)/(a*a+o*o);h>1?(n=r[0],s=r[1]):h>0&&(n+=a*h,s+=o*h)}return a=t-n,o=e-s,a*a+o*o}});var ct=P((zi,dt)=>{dt.exports=function(t,e){var i=[],r=[null],n,s,a,o=0,h=0,d=0,u=0,x=0,y=0,w=0,m=0,v=0,l=0,f=0,c=0;if(t.length<2)return[];if(t.length===2)return d=Math.sqrt(Math.pow(t[1].x-t[0].x,2)+Math.pow(t[1].y-t[0].y,2)),[{length:d,beginIndex:0,beginDistance:0,endIndex:2,endDistance:d,angles:[null,null]}];for(u=Math.sqrt(Math.pow(t[1].x-t[0].x,2)+Math.pow(t[1].y-t[0].y,2)),o=1,h=t.length-1;o<h;o++)n=t[o-1],s=t[o],a=t[o+1],y=s.x-n.x,w=s.y-n.y,m=a.x-s.x,v=a.y-s.y,x=Math.sqrt(m*m+v*v),d+=u,l=Math.acos((y*m+w*v)/(u*x)),r.push(l),l>e&&(i.push({length:d-c,beginDistance:c,beginIndex:f,endIndex:o+1,endDistance:d,angles:r}),f=o,c=d,r=[l]),u=x;return r.push(null),o-f>0&&i.push({length:d-c+x,beginIndex:f,beginDistance:c,endIndex:o+1,endDistance:d+x,angles:r}),i}});var fi={};Tt(fi,{FillSymbolizer:()=>B,LeafletLayer:()=>we,LineLabelSymbolizer:()=>U,LineSymbolizer:()=>C,PolygonLabelSymbolizer:()=>Z,Static:()=>ge,TextSymbolizer:()=>R,exp:()=>V,json_style:()=>Ie});var it=E(Oe()),rt=E(Ke()),nt=E(tt()),ue;(function(t){t[t.Point=1]="Point",t[t.Line=2]="Line",t[t.Polygon=3]="Polygon"})(ue||(ue={}));function J(t){return t.x+":"+t.y+":"+t.z}function st(t){let e=new it.VectorTile(new rt.default(t)),i={};for(let[r,n]of Object.entries(e.layers)){let s=[],a=n;for(let o=0;o<a.length;o++){let h=a.feature(o).loadGeometry(),d=0;for(let u of h)d+=u.length;s.push({geomType:a.feature(o).type,geom:h,vertices:d,bbox:a.feature(o).bbox(),properties:a.feature(o).properties})}i[r]=s}return i}var _e=class{constructor(e,i){this.url=e,this.p=new nt.default.PMTiles(e,i),this.controllers=[]}async get(e){this.controllers=this.controllers.filter(s=>s[0]!=e.z?(s[1].abort(),!1):!0);let i=await this.p.getZxy(e.z,e.x,e.y),r=new AbortController;this.controllers.push([e.z,r]);let n=r.signal;return new Promise((s,a)=>{fetch(this.url,{headers:{Range:"bytes="+i[0]+"-"+(i[0]+i[1]-1)},signal:n}).then(o=>o.arrayBuffer()).then(o=>{let h=st(o);s(h)}).catch(o=>{a(o)})})}},te=class{constructor(e){this.url=e,this.controllers=[]}async get(e){this.controllers=this.controllers.filter(s=>s[0]!=e.z?(s[1].abort(),!1):!0);let i=this.url.replace("{z}",e.z.toString()).replace("{x}",e.x.toString()).replace("{y}",e.y.toString()),r=new AbortController;this.controllers.push([e.z,r]);let n=r.signal;return new Promise((s,a)=>{fetch(i,{signal:n}).then(o=>o.arrayBuffer()).then(o=>{let h=st(o);s(h)}).catch(o=>{a(o)})})}},ie=class{constructor(e){this.source=e,this.cache=new Map,this.inflight=new Map}async get(e){let i=J(e);return new Promise((r,n)=>{if(this.cache.has(i)){let s=this.cache.get(i);s.used=performance.now(),r(s.data)}else this.inflight.has(i)?this.inflight.get(i).push([r,n]):(this.inflight.set(i,[]),this.source.get(e).then(s=>{if(this.cache.set(i,{used:performance.now(),data:s}),this.inflight.get(i).forEach(a=>a[0](s)),this.inflight.delete(i),r(s),this.cache.size>=64){let a=Infinity,o;this.cache.forEach((h,d)=>{h.used<a&&(o=d)}),this.cache.delete(o)}}).catch(()=>{this.inflight.get(i).forEach(s=>s[1]("Cancel data "+i)),this.inflight.delete(i),n("Cancel data "+i)}))})}};var q=E(H()),Me=class{},Se=class extends Me{constructor(e,i,r){super();this.tileCache=e,this.dataResolution=r,this.maxDataLevel=i}async get(){let e=[{z:2,x:0,y:0},{z:2,x:0,y:1},{z:2,x:1,y:0},{z:2,x:1,y:1}];return(await Promise.all(e.map(r=>this.tileCache.get(r)))).map((r,n)=>({data:r,bbox:[0,0,4096,4096],transform:{scale:.25,translate:new q.default(1024*e[n].x,1024*e[n].y)},tile:e[n],z:1}))}},ze=class extends Me{constructor(e,i,r,n,s){super();this.tileCache=e,this.maxDataLevel=i,this.dataResolution=r,this.levelDiff=n,this.displayResolution=s}dataTile(e){var i;if(e.z<this.levelDiff)i={z:0,x:0,y:0};else if(e.z<=this.levelDiff+this.maxDataLevel){let n=1<<this.levelDiff;i={z:e.z-this.levelDiff,x:Math.floor(e.x/n),y:Math.floor(e.y/n)}}else{var r=1<<e.z-this.maxDataLevel;i={z:this.maxDataLevel,x:Math.floor(e.x/r),y:Math.floor(e.y/r)}}return i}covering(e,i,r){let n=1<<e-i.z,s=this.dataResolution,a={x:r.minX/s,y:r.minY/s},o={x:Math.floor(a.x*n),y:Math.floor(a.y*n)},h={x:r.maxX/s,y:r.maxY/s},d={x:Math.floor(h.x*n),y:Math.floor(h.y*n)},u=[];for(let x=o.x;x<=d.x;x++)for(let y=o.y;y<=d.y;y++)Math.floor(x/n)==i.x&&Math.floor(y/n)==i.y||u.push({z:e,x,y});return u}transform(e){let i=this.displayResolution;if(e.z<this.levelDiff){if(e.z==0)return{scale:.0625,translate:new q.default(0,0)};if(e.z==1)return{scale:.125,translate:new q.default(e.x*-i,e.y*-i)}}else if(e.z<=this.levelDiff+this.maxDataLevel){let r=this.dataTile(e),n=1<<this.levelDiff;return{scale:.25,translate:new q.default((e.x-r.x*n)*-i,(e.y-r.y*n)*-i)}}else{let r=this.dataTile(e),n=1<<e.z-(this.maxDataLevel+this.levelDiff),s=(1<<this.levelDiff)*n;return{scale:.25*n,translate:new q.default((e.x-r.x*s)*-i,(e.y-r.y*s)*-i)}}}point(e,i,r){let n=this.displayResolution;if(e.z<this.levelDiff)e.z==0,e.z==1;else if(e.z<=this.levelDiff+this.maxDataLevel){let s=this.dataTile(e),a=1<<this.levelDiff;return new q.default(((e.x-s.x*a)*n+i)*4,((e.y-s.y*a)*n+i)*4)}else{let s=this.dataTile(e),a=1<<e.z-(this.maxDataLevel+this.levelDiff),o=(1<<this.levelDiff)*a}}bbox(e){if(e.z<this.levelDiff)return[0,0,4096,4096];if(e.z<=this.levelDiff+this.maxDataLevel){let i=1<<this.levelDiff,r=this.dataTile(e),n=r.x*i,s=r.y*i,a=e.x-n,o=e.y-s;return[a*1024,o*1024,(a+1)*1024,(o+1)*1024]}else{let i=1024>>e.z-this.maxDataLevel-this.levelDiff,r=this.dataTile(e),n=1<<e.z-this.maxDataLevel,s=r.x*n,a=r.y*n,o=e.x-s,h=e.y-a;return[o*i,h*i,(o+1)*i,(h+1)*i]}}async get(e){let i=this.dataTile(e);return{data:await this.tileCache.get(i),transform:this.transform(e),bbox:this.bbox(e),z:e.z,data_tile:i}}async within(e,i,r){let n=this.dataTile(e),s=await this.tileCache.get(n),a=this.point(e,i,r),o=[];for(let[h,d]of Object.entries(s))for(let u of d){let x=u.bbox;x[0]<a.x&&x[1]<a.y&&x[2]>a.x&&x[3]>a.y&&o.push([h,u])}return o}};var ke=E(H());function de(t,e,i,r,n,s){let a=performance.now(),o;if(t.ctx?o=t.ctx:(o=t.element.getContext("2d",{alpha:!1}),t.ctx=o),t.element&&t.element.key!=e)return;o.setTransform(t.tile_size/256,0,0,t.tile_size/256,0,0),o.save(),o.fillStyle="rgba(0,0,0,1)",o.globalCompositeOperation="destination-out",o.fillRect(0,0,256,256),o.restore(),o.miterLimit=1;for(var h of n){var d=i.data[h.dataLayer];if(d!==void 0){h.symbolizer.before(o,i.z);for(var u of d){var x=u.bbox,y=i.bbox;x[2]<y[0]||x[0]>y[2]||x[1]>y[3]||x[3]<y[1]||h.filter&&!h.filter(u.properties)||h.symbolizer.draw(o,u.geom,i.transform)}}}let w=r.data.search(r.bbox);for(var m of w)if(m.draw(o,m.anchor.clone().mult(r.transform.scale).add(r.transform.translate)),s){o.lineWidth=1,o.strokeStyle="black",o.fillStyle="black",o.globalAlpha=1;let v=new ke.default(m.minX,m.minY).mult(r.transform.scale).add(r.transform.translate),l=new ke.default(m.maxX,m.maxY).mult(r.transform.scale).add(r.transform.translate),f=m.anchor.clone().mult(r.transform.scale).add(r.transform.translate);o.strokeRect(v.x,v.y,l.x-v.x,l.y-v.y),o.fillRect(f.x-2,f.y-2,4,4)}return performance.now()-a}var j=E(H());var ot=E(at()),De=class{constructor(e,i,r,n){this.tree=new ot.default,this.view=e,this.z=i,this.scratch=r,this.labelStyle=n}layout(e,i){let r=performance.now();if(!this.active)return!1;let n=new Set,s=1<<this.z-e.z-this.view.levelDiff,a=this.view.dataResolution;for(var[o,h]of this.labelStyle.entries()){if(h.visible==!1)continue;let d=i[h.dataLayer];if(d===void 0)continue;let u=d;h.sort&&u.sort((x,y)=>h.sort(x.properties,y.properties));for(let x of u){if(h.filter&&!h.filter(x.properties))continue;let y=h.symbolizer.stash(this.scratch,x,this.z);if(!y)continue;let w=y.anchor,m=y.bbox,v={minX:(e.x*a+w.x)*s+m.minX,minY:(e.y*a+w.y)*s+m.minY,maxX:(e.x*a+w.x)*s+m.maxX,maxY:(e.y*a+w.y)*s+m.maxY},l=this.tree.search(v);if(l.length==0){let f={anchor:new j.default(e.x*a+w.x,e.y*a+w.y).mult(s),draw:y.draw,order:o,key:J(e)};this.tree.insert(Object.assign(f,v));let c=a*s;(v.maxX>(e.x+1)*c||v.minX<e.x*c||v.minY<e.y*c||v.maxY>(e.y+1)*c)&&this.findSpills(n,e,v)}else{let f=!0;for(let c of l)o>=c.order&&(f=!1);if(f){for(let g of l)this.findSpills(n,e,g),this.tree.remove(g);let c={anchor:new j.default(e.x*a+w.x,e.y*a+w.y).mult(s),draw:y.draw,order:o};this.tree.insert(Object.assign(c,v))}}}}return n.size>0&&this.listener(n),!0}},Ce=class extends De{constructor(e,i,r,n){super(e,i,r,n);this.active=!0}async get(){let e=await this.view.get();for(let i of e)this.layout(i.tile,i.data);return{data:this.tree,bbox:{minX:0,minY:0,maxX:16384,maxY:16384},transform:{scale:.25,translate:new j.default(-0,-0)}}}findSpills(){}},lt=class extends De{constructor(e,i,r,n,s){super(e,i,r,n);this.active=!1;this.current=new Set,this.inflight=new Map,this.listener=s}findSpills(e,i,r){let n=this.view.covering(this.z,i,r);for(let s of n){let a=J({z:s.z-2,x:Math.floor(s.x/4),y:Math.floor(s.y/4)});this.current.has(a)&&e.add(J(s))}}getTree(e){let i=J(e);return new Promise((r,n)=>{this.current.has(i)?r(this.tree):this.inflight.get(i)?this.inflight.get(i).push([r,n]):(this.inflight.set(i,[]),this.view.tileCache.get(e).then(s=>{if(this.layout(e,s)){if(this.current.add(i),this.inflight.get(i).forEach(o=>o[0](this.tree)),this.inflight.delete(i),r(this.tree),this.current.size>16){let o,h=0;for(let u of this.current){let x=u.split(":"),y=Math.sqrt(Math.pow(x[0]-e.x,2)+Math.pow(x[1]-e.y,2));y>h&&(h=y,o=u)}this.current.delete(o);let d=[];for(let u of this.tree.all())u.key===o&&d.push(u);d.forEach(u=>{this.tree.remove(u)})}}else this.inflight.get(i).forEach(o=>o[1]("Cancel label")),this.inflight.delete(i),n("Cancel label")}).catch(s=>{this.inflight.get(i).forEach(a=>a[1](s)),this.inflight.delete(i),n(s)}))})}bbox(e){let i=this.view.dataResolution/(1<<this.view.levelDiff);return{minX:e.x*i,minY:e.y*i,maxX:(e.x+1)*i,maxY:(e.y+1)*i}}transform(e){let i=this.view.dataResolution/(1<<this.view.levelDiff);if(e.z<this.view.levelDiff){if(e.z==0)return{scale:.0625,translate:new j.default(0,0)};if(e.z==1)return{scale:.125,translate:new j.default(e.x*-this.view.displayResolution,e.y*-this.view.displayResolution)}}else return{scale:.25,translate:new j.default(-e.x*i/4,-e.y*i/4)}}async get(e){let i=this.view.dataTile(e);return{data:await this.getTree(i),bbox:this.bbox(e),transform:this.transform(e)}}},ce=class{constructor(e,i,r,n){this.labelers=new Map,this.view=e,this.scratch=i,this.labelStyle=r,this.listener=n}async get(e){return this.labelers.forEach((i,r)=>{i.active=!1}),this.labelers.get(e.z)||this.labelers.set(e.z,new lt(this.view,e.z,this.scratch,this.labelStyle,this.listener)),this.labelers.get(e.z).active=!0,this.labelers.get(e.z).get(e)}};var me=E(H());var yt=E(ut());var xt=E(ct());function mt(t,e){let i,r,n=0;for(let s of t){let a=(0,xt.default)(s,Math.PI/2/9);for(let o of a)o.length>=e&&o.length>n&&(n=o.length,i=s[o.beginIndex],r=s[o.endIndex-1])}if(!!i)return{start:i,end:r}}var B=class{constructor(e){this.fill=e.fill||"#000000",this.opacity=e.opacity||1}before(e){e.fillStyle=this.fill,e.globalAlpha=this.opacity}draw(e,i,r){e.beginPath();for(var n of i)for(var s=0;s<n.length-1;s++){let a=n[s].mult(r.scale).add(r.translate);s==0?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y)}e.fill()}};function V(t,e,i){if(t<=i[0][0])return i[0][1];if(t>=i[i.length-1][0])return i[i.length-1][1];let r=0;for(;i[r+1][0]<t;)r++;let n=(t-i[r][0])/(i[r+1][0]-i[r][0]),s=Math.pow(n,e);return i[r][1]+s*(i[r+1][1]-i[r][1])}function pt(t){return!!(t&&t.constructor&&t.call&&t.apply)}var C=class{constructor(e){this.color=e.color||"#000000",this.width=e.width||1,this.opacity=e.opacity||1}before(e,i){e.strokeStyle=this.color,e.globalAlpha=this.opacity,pt(this.width)&&this.width.length==1?e.lineWidth=this.width(i):e.lineWidth=this.width}draw(e,i,r){e.beginPath();for(var n of i)for(var s=0;s<n.length;s++){let a=n[s].mult(r.scale).add(r.translate);s==0?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y)}e.stroke()}},R=class{constructor(e){this.fill=e.fill,this.font=e.font,this.property=e.property||"name",this.stroke=e.stroke||"black",this.width=e.width||0,this.align=e.align||"left"}stash(e,i,r){let n=i.properties[this.property];if(!n)return null;if(i.geomType==ue.Point){let s=new me.default(i.geom[0][0].x,i.geom[0][0].y),a=this.font;pt(this.font)&&(a=this.font(i.properties,r)),e.font=a;let o=e.measureText(n),h=2,d=o.width,u=o.actualBoundingBoxAscent,x=o.actualBoundingBoxDescent,y={minX:0,minY:-u*4,maxX:d*4,maxY:x*4},w=[-h,-u-h,d+h*2,u+x+h*2],m=0;return this.align=="center"&&(y={minX:-d*4/2,minY:-u*4,maxX:d*4/2,maxY:x*4},w=[-h-d/2,-u-h,d+h*2,u+x+h*2],m=-d/2),{anchor:s,bbox:y,draw:(l,f)=>{l.globalAlpha=1,l.font=a,this.width&&(l.lineWidth=this.width,l.strokeStyle=this.stroke,l.strokeText(n,f.x+m,f.y)),l.fillStyle=this.fill,l.fillText(n,f.x+m,f.y)}}}}},U=class{constructor(e){this.fill=e.fill||"black",this.stroke=e.stroke||"black",this.width=e.width||0,this.font=e.font||"12px sans-serif"}stash(e,i){let r=i.properties.name;if(!r)return;let n=i.bbox;if((n[3]-n[1])*(n[2]-n[0])<100)return;e.font=this.font;let o=e.measureText(r).width,h=mt(i.geom,o);if(!h)return;let d=h.end.x-h.start.x,u=h.end.y-h.start.y,x=new me.default(h.start.x,h.start.y);var y=0,w=d,m=0,v=u;d<0&&(y=d,w=0),u<0&&(m=u,v=0);let l={minX:y*4,minY:m*4,maxX:w*4,maxY:v*4};return{anchor:x,bbox:l,draw:(c,g)=>{c.beginPath(),c.globalAlpha=1,c.moveTo(g.x,g.y),c.save(),c.translate(g.x,g.y),c.rotate(Math.atan2(u,d)),d<0&&c.scale(0,-1),c.font=this.font,this.stroke>0&&(c.strokeStyle=this.stroke,c.lineWidth=this.width,c.strokeText(r,0,0)),c.fillStyle=this.fill,c.fillText(r,0,0),c.restore()}}}},Z=class{constructor(e){this.fill=e.fill||"black",this.font=e.font||"16px sans-serif"}stash(e,i){let r=i.bbox;if((r[3]-r[1])*(r[2]-r[0])<2e5)return;let s=i.properties.name;if(!s)return null;let a=i.geom[0],o=(0,yt.default)([a.map(m=>[m.x,m.y])]),h=new me.default(o[0],o[1]);e.font=this.font;let d=e.measureText(s),u=d.width,x={minX:-u*4/2,minY:-d.actualBoundingBoxAscent*4,maxX:u*4/2,maxY:d.actualBoundingBoxDescent*4},y=this.fill;return{anchor:h,bbox:x,draw:(m,v)=>{m.globalAlpha=1,m.fillStyle=y,m.font=this.font,m.fillText(s,v.x-u/2,v.y)}}}};var ye=t=>[{dataLayer:"earth",symbolizer:new B({fill:t.earth})},{dataLayer:"natural",symbolizer:new B({fill:t.glacier}),filter:e=>e.natural=="glacier"},{dataLayer:"landuse",symbolizer:new B({fill:t.residential}),filter:e=>e.landuse=="residential"||e.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new B({fill:t.hospital}),filter:e=>e.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new B({fill:t.cemetery}),filter:e=>e.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new B({fill:t.school}),filter:e=>e.amenity=="school"||e.amenity=="kindergarten"||e.amenity=="university"||e.amenity=="college"},{dataLayer:"landuse",symbolizer:new B({fill:t.industrial}),filter:e=>e.landuse=="industrial"},{dataLayer:"natural",symbolizer:new B({fill:t.wood}),filter:e=>e.natural=="wood"},{dataLayer:"landuse",symbolizer:new B({fill:t.grass}),filter:e=>e.landuse=="grass"},{dataLayer:"landuse",symbolizer:new B({fill:t.park}),filter:e=>e.leisure=="park"},{dataLayer:"water",symbolizer:new B({fill:t.water})},{dataLayer:"natural",symbolizer:new B({fill:t.sand}),filter:e=>e.natural=="sand"},{dataLayer:"buildings",symbolizer:new B({fill:t.buildings})},{dataLayer:"roads",symbolizer:new C({color:t.highwayCasing,width:e=>V(e,1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:e=>e["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new C({color:t.majorRoadCasing,width:e=>V(e,1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:e=>e["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new C({color:t.mediumRoadCasing,width:e=>V(e,1.4,[[13,3],[17,6],[20,18]])}),filter:e=>e["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new C({color:t.minorRoadCasing,width:e=>V(e,1.4,[[14,2],[17,5],[20,15]])}),filter:e=>e["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new C({color:t.highway,width:e=>V(e,1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:e=>e["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new C({color:t.majorRoad,width:e=>V(e,1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:e=>e["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new C({color:t.mediumRoad,width:e=>V(e,1.4,[[13,2],[17,4],[20,15]])}),filter:e=>e["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new C({color:t.minorRoad,width:e=>V(e,1.4,[[14,1],[17,3],[20,13]])}),filter:e=>e["pmap:kind"]=="minor_road"},{dataLayer:"boundaries",symbolizer:new C({color:t.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new B({fill:t.mask})}],pe=t=>[{dataLayer:"places",symbolizer:new R({fill:t.countryLabel,font:(e,i)=>i<6?"800 14px sans-serif":"800 20px sans-serif",align:"center"}),filter:e=>e["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:new R({fill:t.cityLabel,font:(e,i)=>e["pmap:rank"]==1?i>8?"600 24px sans-serif":"400 14px sans-serif":i>8?"400 20px sans-serif":"400 12px sans-serif"}),sort:(e,i)=>e["pmap:rank"]-i["pmap:rank"],filter:e=>e["pmap:kind"]=="city"},{dataLayer:"places",symbolizer:new R({fill:t.stateLabel,font:"600 16px sans-serif"}),filter:e=>e["pmap:kind"]=="state"},{dataLayer:"places",symbolizer:new R({fill:t.neighbourhoodLabel,font:"400 12px sans-serif"}),filter:e=>e["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:new Z({fill:t.landuseLabel,font:"400 14px sans-serif"})},{dataLayer:"water",symbolizer:new Z({fill:t.waterLabel,font:"italic 600 16px sans-serif"})},{dataLayer:"natural",symbolizer:new Z({fill:t.naturalLabel,font:"italic 400 12px sans-serif"})},{dataLayer:"roads",symbolizer:new U({fill:t.roadsLabel})},{dataLayer:"pois",symbolizer:new R({fill:t.poisLabel,font:"400 10px sans-serif"})}];var gt={earth:"#FFFBF6",glacier:"#ffffff",residential:"#e7e7e7",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#dddddd",cityLabel:"#6C6C6C",stateLabel:"#cccccc",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#717171",naturalLabel:"4c4c4c",roadsLabel:"#888888",poisLabel:"#606060"},re=ye(gt),ne=pe(gt);var ge=class{constructor(e){this.paint_style=e.paint_style||re,this.label_style=e.label_style||ne;let i=new ie(new te(e.url));this.view=new Se(i,14,4096),this.debug=e.debug||!1}async draw(e){let i=new Ce(this.view,1,e,this.label_style),r=await this.view.get(),n=await i.get();for(let s of r){let a=de({ctx:e},"key",s,n,this.paint_style,!1)}}};var wt={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"},Xe=ye(wt),Ee=pe(wt);var bt=class{constructor(){this.unused=[]}get(e,i){if(this.unused.length){let n=this.unused.shift();return n.removed=!1,n}let r=L.DomUtil.create("canvas","leaflet-tile");return r.width=e,r.height=e,r}put(e){L.DomEvent.off("click"),L.DomUtil.removeClass(e,"leaflet-tile-loaded"),this.unused.push(e)}},we=class extends L.GridLayer{constructor(e){e.noWrap&&!e.bounds&&(e.bounds=[[-90,-180],[90,180]]),super(e),this.paint_style=e.paint_style||(e.dark?Xe:re),this.label_style=e.label_style||(e.dark?Ee:ne);let i;e.url.endsWith(".pmtiles")?i=new _e(e.url,{allow_200:e.allow_200}):i=new te(e.url);let r=new ie(i);this.view=new ze(r,14,4096,2,256),this.debug=e.debug||!1,this.lang=e.lang;let n=document.createElement("canvas").getContext("2d");this.scratch=n,this.knockoutTiles=s=>{s.forEach(a=>{this.rerenderTile(a)})},this.labelers=new ce(this.view,this.scratch,this.label_style,this.knockoutTiles),this.tile_size=256*window.devicePixelRatio,this.pool=new bt,this._onClick=null}setDefaultStyle(e){this.paint_style=e?Xe:re,this.label_style=e?Ee:ne}onClick(e){this._onClick=e}async renderTile(e,i,r,n=()=>{}){let s={element:i,tile_size:this.tile_size,ctx:null};var a,o;try{a=await this.view.get(e),o=await this.labelers.get(e)}catch(w){return}if(!this._map)return;let h=this._map.getCenter().wrap();var d=this._getTiledPixelBounds(h),u=this._pxBoundsToTileRange(d),x=u.getCenter();let y=e.distanceTo(x)*10;setTimeout(()=>{let w=de(s,r,a,o,this.paint_style,this.debug);if(this.debug){let m=s.ctx;if(!m)return;let v=this.view.dataTile(e);m.save(),m.fillStyle="black",m.globalAlpha=.5,m.fillStyle="#000",m.font="800 12px sans-serif",m.fillText(e.z+" "+e.x+" "+e.y,4,14),(v.x%2+v.y%2)%2==0?m.fillStyle="black":m.fillStyle="blue",m.fillText(v.z+" "+v.x+" "+v.y,4,28),m.fillStyle="red",w>8&&m.fillText(w.toFixed()+" ms",4,42),m.strokeStyle="#000",m.strokeRect(0,0,256,256),m.restore()}n()},y)}rerenderTile(e){for(var i in this._tiles){let r=this._wrapCoords(this._keyToTileCoords(i));e===this._tileCoordsToKey(r)&&this.renderTile(r,this._tiles[i].el,e)}}clearLayout(){this.labelers=new ce(this.view,this.scratch,this.label_style,this.knockoutTiles)}rerenderTiles(){for(var e in this._tiles){let i=this._wrapCoords(this._keyToTileCoords(e)),r=this._tileCoordsToKey(i);this.renderTile(i,this._tiles[e].el,r)}}createTile(e,i){let r=this.pool.get(this.tile_size,s=>{let a=this._map.mouseEventToLatLng(s);this.view.within(e,s.offsetX,s.offsetY).then(o=>{this._onClick(a,o)})}),n=this._tileCoordsToKey(e);return r.key=n,this.renderTile(e,r,n,()=>{i(null,r)}),r}_removeTile(e){var i=this._tiles[e];!i||(i.el.removed=!0,i.el.key=void 0,L.DomUtil.remove(i.el),this.pool.put(i.el),delete this._tiles[e],this.fire("tileunload",{tile:i.el,coords:this._keyToTileCoords(e)}))}};function Ye(t){if(t.includes("$type"))return e=>!0;if(t[0]=="==")return e=>e[t[1]]===t[2];if(t[0]=="!=")return e=>e[t[1]]!==t[2];if(t[0]==="<")return e=>e[t[1]]<t[2];if(t[0]===">")return e=>e[t[1]]>t[2];if(t[0]==="in")return e=>t.slice(2,t.length).includes(e[t[1]]);if(t[0]==="!in")return e=>!t.slice(2,t.length).includes(e[t[1]]);if(t[0]==="has")return e=>e.hasOwnProperty(t[1]);if(t[0]==="all"){let e=t.slice(1,t.length).map(i=>Ye(i));return i=>e.every(r=>r(i))}else if(t[0]==="any"){let e=t.slice(1,t.length).map(i=>Ye(i));return i=>e.some(r=>r(i))}else console.log("Unimplemented: ",t[0])}function vt(t){if(!t||typeof t=="number")return t;if(t.base&&t.stops)return e=>V(e,t.base,t.stops);console.log("Unimplemented: ",t)}function hi(t,e={}){let i=[];for(let n of t["text-font"])e.hasOwnProperty(n)&&i.push(e[n]);i.length===0&&i.push("sans-serif");let r=t["text-size"];if(typeof r=="number")return`${r}px ${i.join(", ")}`;if(r.stops)return r.base||=1.4,n=>`${vt(r)(n)}px ${i.join(", ")}`;console.log("Can't parse font: ",t)}function Ie(t){let e=[],i=[],r=new Map;for(var n of t.layers){if(r.set(n.id,n),n.layout&&n.layout.visibility=="none")continue;if(n.ref){let h=r.get(n.ref);n.type=h.type,n.filter=h.filter,n.source=h.source,n["source-layer"]=h["source-layer"]}let o=n["source-layer"];var s,a=void 0;n.filter&&(a=Ye(n.filter)),n.type=="fill"?e.push({dataLayer:n["source-layer"],filter:a,symbolizer:new B({fill:n.paint["fill-color"],opacity:n.paint["fill-opacity"]})}):n.type=="line"?e.push({dataLayer:n["source-layer"],filter:a,symbolizer:new C({color:n.paint["line-color"],width:vt(n.paint["line-width"])})}):n.type=="symbol"&&(n.layout["symbol-placement"]=="line"?i.push({dataLayer:n["source-layer"],filter:a,symbolizer:new U({fill:n.paint["text-color"],width:n.paint["text-halo-width"],stroke:n.paint["text-halo-color"]})}):i.push({dataLayer:n["source-layer"],filter:a,symbolizer:new R({font:hi(n.layout),fill:n.paint["text-color"],stroke:n.paint["text-halo-color"],width:n.paint["text-halo-width"]})}))}return{paint_style:e,label_style:i}}return fi;})();
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
